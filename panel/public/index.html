<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hytale Server Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <!-- Login Screen -->
  <div class="login-screen" id="login-screen">
    <div class="login-box">
      <div class="login-header">
        <div class="login-logo">
          <div class="login-logo-block">H</div>
          <div class="login-title">HYTALE</div>
        </div>
        <div class="login-subtitle">Server Panel</div>
      </div>
      <form class="login-form" id="login-form">
        <div class="login-warning" id="login-warning">
          ⚠️ Using default credentials! Set PANEL_USER and PANEL_PASS environment variables.
        </div>
        <div class="login-error" id="login-error"></div>
        <div class="login-field">
          <label class="login-label">Username</label>
          <input type="text" class="login-input" id="login-username" placeholder="admin" autocomplete="username">
        </div>
        <div class="login-field">
          <label class="login-label">Password</label>
          <input type="password" class="login-input" id="login-password" placeholder="••••••••" autocomplete="current-password">
        </div>
        <button type="submit" class="login-btn" id="login-btn">LOGIN</button>
      </form>
    </div>
  </div>

  <!-- Main Content -->
  <div class="container hidden" id="main-content">
    <header>
      <div class="logo">
        <div class="logo-block">H</div>
        <div>
          <h1>HYTALE</h1>
          <div class="logo-subtitle">Server Panel</div>
        </div>
      </div>
      <div class="header-right">
        <div class="lang-selector">
          <select class="lang-dropdown" id="lang-select">
            <option value="en">English</option>
            <option value="es">Español</option>
            <option value="uk">Українська</option>
          </select>
        </div>
        <span class="uptime-display" id="uptime">00:00:00</span>
        <div class="status-badge">
          <div class="status-dot" id="status-dot"></div>
          <span class="status-text" id="status-text">Offline</span>
        </div>
        <button class="logout-btn" id="logout-btn">Logout</button>
      </div>
    </header>

    <div class="grid">
      <div class="main">
        <div class="card">
          <div class="card-header">Console</div>
          <div class="console" id="console"></div>
          <div class="command-bar">
            <input type="text" id="cmd-input" placeholder="Enter command..." autocomplete="off">
            <button id="send-btn">SEND</button>
          </div>
        </div>
        <button class="btn-show-sidebar" id="btn-show-sidebar" title="Show Panel">☰</button>
      </div>

      <div class="sidebar">
        <div class="card">
          <div class="tabs-header">
            <button class="tab-btn active" data-tab="setup">Setup</button>
            <button class="tab-btn" data-tab="files">Files</button>
            <button class="tab-btn" data-tab="mods">Mods</button>
            <button class="tab-btn" data-tab="commands">Commands</button>
            <button class="tab-btn" data-tab="control">Control</button>
          </div>

          <!-- Setup Tab -->
          <div class="tab-content active" id="tab-setup">
            <div class="file-status" id="file-status">
              <span id="setup-icon">?</span>
              <span id="setup-text">Checking...</span>
            </div>
            <div class="file-checks">
              <div class="file-check" id="check-jar"><span class="icon">○</span><span>Server.jar</span></div>
              <div class="file-check" id="check-assets"><span class="icon">○</span><span>Assets.zip</span></div>
            </div>
            <div class="auth-status" id="auth-status">Checking...</div>

            <div class="auth-box" id="auth-box">
              <h3>Auth Required</h3>
              <p>Open link:</p>
              <a href="#" id="auth-link" target="_blank"></a>
              <p style="margin-top: 8px">Code:</p>
              <div class="auth-code" id="auth-code">--------</div>
            </div>

            <div class="progress-section" id="progress-section">
              <div class="progress-header">
                <span class="progress-status" id="progress-status">...</span>
                <span class="progress-time" id="progress-time">0s</span>
              </div>
              <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
              <div class="progress-steps">
                <div class="progress-step" id="step-auth"><span>○</span><span>Auth</span></div>
                <div class="progress-step" id="step-download"><span>○</span><span>Download</span></div>
                <div class="progress-step" id="step-extract"><span>○</span><span>Extract</span></div>
                <div class="progress-step" id="step-complete"><span>○</span><span>Done</span></div>
              </div>
            </div>

            <button class="mc-btn primary" id="download-btn">Download Files</button>
            <p class="hint">Downloads ~2GB from Hytale</p>
          </div>

          <!-- Files Tab -->
          <div class="tab-content" id="tab-files">
            <div class="file-breadcrumb" id="file-breadcrumb">
              <span class="breadcrumb-item" data-path="/">/opt/hytale</span>
            </div>

            <div class="file-toolbar">
              <button class="mc-btn small" id="btn-refresh" title="Refresh">↻</button>
              <button class="mc-btn small" id="btn-new-folder" title="New Folder">+ Dir</button>
              <button class="mc-btn small" id="btn-upload" title="Upload">Upload</button>
            </div>

            <div class="upload-zone" id="upload-zone">
              <div class="upload-content">
                <div class="upload-icon">⬆</div>
                <div class="upload-text">Drop files here</div>
                <div class="upload-hint">Max 100MB | .jar .zip .json .yaml</div>
                <input type="file" id="file-input" style="display:none" multiple>
              </div>
              <div class="upload-progress" id="upload-progress">
                <div class="upload-progress-bar"><div class="upload-progress-fill" id="upload-progress-fill"></div></div>
                <div class="upload-progress-text" id="upload-progress-text">Uploading...</div>
              </div>
            </div>

            <div class="file-list" id="file-list">
              <div class="file-list-header">
                <span class="file-col-name">Name</span>
                <span class="file-col-size">Size</span>
                <span class="file-col-actions"></span>
              </div>
              <div class="file-list-body" id="file-list-body">
                <div class="file-empty">Loading...</div>
              </div>
            </div>
          </div>

          <!-- Mods Tab -->
          <div class="tab-content" id="tab-mods">
            <!-- View Toggle & Check Updates -->
            <div class="mods-view-toggle">
              <span class="mods-api-dot" id="mods-api-status" title="Modtale API"></span>
              <button class="mc-btn small active" id="btn-view-installed" data-i18n="installed">Installed</button>
              <button class="mc-btn small" id="btn-view-browse" data-i18n="browse">Browse</button>
              <button class="mc-btn small" id="btn-check-updates">⟳ <span data-i18n="checkUpdates">Updates</span></button>
            </div>

            <!-- Search (shown in browse mode) -->
            <div class="mods-search hidden" id="mods-search">
              <input type="text" class="mods-search-input" id="mods-search-input" data-i18n-placeholder="searchForMods" placeholder="Search mods...">
              <select class="mods-filter-select" id="mods-classification-filter">
                <option value="" data-i18n="allTypes">All Types</option>
                <option value="PLUGIN" data-i18n="typePlugin">Plugins</option>
                <option value="DATA" data-i18n="typeData">Data</option>
                <option value="ART" data-i18n="typeArt">Art</option>
                <option value="SAVE" data-i18n="typeSave">Saves</option>
                <option value="MODPACK" data-i18n="typeModpack">Modpacks</option>
              </select>
              <button class="mc-btn small" id="btn-search-mods" data-i18n="search">Search</button>
            </div>

            <!-- Installed Mods List -->
            <div class="mods-list" id="installed-mods-list">
              <div class="mods-empty" id="mods-loading" data-i18n="loading">Loading...</div>
            </div>

            <!-- Search Results (hidden by default) -->
            <div class="mods-list hidden" id="search-mods-list">
              <div class="mods-empty" data-i18n="searchForMods">Search for mods</div>
            </div>

            <!-- Pagination -->
            <div class="mods-pagination hidden" id="mods-pagination">
              <button class="mc-btn small" id="btn-prev-page" disabled>&lt; <span data-i18n="prev">Prev</span></button>
              <span class="mods-page-info" id="mods-page-info">Page 1</span>
              <button class="mc-btn small" id="btn-next-page"><span data-i18n="next">Next</span> &gt;</button>
            </div>
          </div>

          <!-- Commands Tab -->
          <div class="tab-content" id="tab-commands">
            <div class="cmd-section">
              <div class="cmd-label">Auth</div>
              <button class="quick-btn" data-cmd="/auth login device"><span>Login</span><span class="cmd">/auth login device</span></button>
              <button class="quick-btn" data-cmd="/auth status"><span>Status</span><span class="cmd">/auth status</span></button>
              <button class="quick-btn" data-cmd="/auth persistence Encrypted"><span>Save Creds</span><span class="cmd">/auth persistence Encrypted</span></button>
            </div>
            <div class="cmd-section">
              <div class="cmd-label">Server</div>
              <button class="quick-btn" data-cmd="/help"><span>All Commands</span><span class="cmd">/help</span></button>
              <button class="quick-btn" data-cmd="/stop"><span>Stop</span><span class="cmd">/stop</span></button>
            </div>
          </div>

          <!-- Control Tab -->
          <div class="tab-content" id="tab-control">
            <div class="control-grid">
              <button class="mc-btn primary small" id="start-btn">START</button>
              <button class="mc-btn small" id="restart-btn">RESTART</button>
            </div>
            <button class="mc-btn danger small" id="stop-btn">STOP SERVER</button>
            <button class="mc-btn warning small" id="wipe-btn" style="margin-top: 8px;">WIPE DATA</button>

            <div class="info-compact">
              <div class="info-row"><span class="info-label">Status</span><span class="info-value" id="info-status">Unknown</span></div>
              <div class="info-row"><span class="info-label">Game</span><span class="info-value">5520/UDP</span></div>
              <div class="info-row"><span class="info-label">Panel</span><span class="info-value">3000/TCP</span></div>
            </div>
          </div>

          <div class="sidebar-toolbar">
            <button class="sidebar-btn" id="btn-expand-panel" title="Expand">⤢</button>
            <button class="sidebar-btn" id="btn-hide-sidebar" title="Hide">✕</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Editor Modal -->
  <div class="editor-modal" id="editor-modal">
    <div class="editor-container">
      <div class="editor-header">
        <span class="editor-filename" id="editor-filename">filename.json</span>
        <div class="editor-actions">
          <label class="editor-checkbox">
            <input type="checkbox" id="editor-backup" checked> Backup
          </label>
          <button class="mc-btn small primary" id="btn-save">Save</button>
          <button class="mc-btn small" id="btn-close-editor">Close</button>
        </div>
      </div>
      <div class="editor-body">
        <textarea id="editor-content" spellcheck="false"></textarea>
      </div>
      <div class="editor-status" id="editor-status">Ready</div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/i18n.js"></script>
  <script src="/js/utils.js"></script>
  <script src="/js/console.js"></script>
  <script src="/js/fileManager.js"></script>
  <script src="/js/modManager.js"></script>
  <script src="/js/app.js"></script>
  <script src="/js/auth.js"></script>
</body>
</html>
